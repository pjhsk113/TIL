# 1장. 사용자 수에 따른 규모 확장성

한 명의 사용자를 지원하는 시스템에서부터 수 백만 사용자를 지원하는 시스템을 만드는 방법을 알아보자.

## 사용자의 요청이 처리되는 과정

1. 사용자가 웹 브라우저에 URL을 입력한다.
2. 입력된 URL 정보는 DNS에서 IP 주소로 변환된다.
3. DNS 조회 결과로 IP 주소가 반환되고 해당 IP 주소로 HTTP 요청이 전달된다.
4. 요청 받은 웹 서버는 HTML 페이지나 JSON 형태의 응답을 반환한다.

## 사용자 수에 따른 시스템 설계

만약 단 한 명의 사용자만 이용하는 시스템이라면 웹 앱, 데이터베이스, 캐시 등을 한 대의 서버즉, **단일 서버에서** 실행해도 아무 문제가 없다.

하지만 위와 같은 시스템은 **트래픽이 증가하고 서버의 리소스가 부족해지면** 아주 쉽게 망가질 수 있다. 이때 생각해볼 수 있는 해결 방법은 여러 서버를 두어 하나는 웹/모바일 트래픽 처리 용도로 사용하고 다른 하나는 데이터베이스용으로 사용하는 것이다.

이렇게 서버를 분리하면 **웹 계층**과 **데이터 계층**이 분리되어 각각을 독립적으로 확장해 나갈 수 있게 된다.

## 수직적 규모 확장(scale up)과 수평적 규모 확장(scale out)

- 수직적 규모 확장(scale up)
    - 수직적 규모 확장은 서버에 더 좋은 CPU, 더 많은 RAM 등을 추가하는 방법을 말한다.
- 수평적 규모 확장(scale out)
    - 더 많은 서버를 추가해 성능을 개선하는 방법을 말한다.

수직적 확장은 아주 단순한 개념이기 때문에 적은 트래픽이 발생하는 경우 좋은 방법이 될 수도 있다.
하지만 불행히도 이 방법에는 몇 가지 심각한 단점이 있다.

첫 째, 하드웨어의 특성 상 고사양 자원을 무한대로 증설할 방법이 존재하지 않는다.

둘 째, 장애에 대한 대응 즉, 다중화나 자동복구에 대한 방안이 없어 서버 장애 발생 시 웹/앱이 완전히 중단된다.

이러한 단점때문에 대규모 시스템을 구성할 때는 수평적 규모 확장(scale out)이 적절하다.

## 로드밸런서

로드밸런서는 부하 분산 집합에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역할을 한다.

하나의 웹 서버에 너무 많은 사용자가 몰리게되면 응답 속도가 느려지거나 접속이 불가능해질 수 있다.
이런 경우 수평적 규모 확장으로 웹 서버를 늘리고 로드밸런서를 도입해 적절히 트래픽 부하를 분산시켜 문제를 해결 할 수 있다.